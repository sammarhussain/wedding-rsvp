<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding RSVP - Umar & Aiman</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600;700&family=Montserrat:wght@300;400;600&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(183, 149, 197, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 700px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            position: relative;
            z-index: 1;
            animation: fadeInUp 0.8s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .floral-border {
            position: absolute;
            pointer-events: none;
        }

        .floral-border.top-left {
            top: 0;
            left: 0;
            width: 150px;
            height: 150px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M10,10 Q20,5 30,10 Q35,20 30,30 Q20,35 10,30 Q5,20 10,10 M15,15 Q20,12 25,15 Q27,20 25,25 Q20,27 15,25 Q12,20 15,15" fill="%23b795c5" opacity="0.3"/><path d="M30,30 Q40,25 50,30 Q55,40 50,50 Q40,55 30,50 Q25,40 30,30 M35,35 Q40,32 45,35 Q47,40 45,45 Q40,47 35,45 Q32,40 35,35" fill="%237877c6" opacity="0.3"/></svg>') no-repeat;
            background-size: contain;
        }

        .floral-border.top-right {
            top: 0;
            right: 0;
            width: 150px;
            height: 150px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M90,10 Q80,5 70,10 Q65,20 70,30 Q80,35 90,30 Q95,20 90,10 M85,15 Q80,12 75,15 Q73,20 75,25 Q80,27 85,25 Q88,20 85,15" fill="%23b795c5" opacity="0.3"/><path d="M70,30 Q60,25 50,30 Q45,40 50,50 Q60,55 70,50 Q75,40 70,30 M65,35 Q60,32 55,35 Q53,40 55,45 Q60,47 65,45 Q68,40 65,35" fill="%237877c6" opacity="0.3"/></svg>') no-repeat;
            background-size: contain;
        }

        .floral-border.bottom-left {
            bottom: 0;
            left: 0;
            width: 150px;
            height: 150px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M10,90 Q20,95 30,90 Q35,80 30,70 Q20,65 10,70 Q5,80 10,90 M15,85 Q20,88 25,85 Q27,80 25,75 Q20,73 15,75 Q12,80 15,85" fill="%23b795c5" opacity="0.3"/><path d="M30,70 Q40,75 50,70 Q55,60 50,50 Q40,45 30,50 Q25,60 30,70 M35,65 Q40,68 45,65 Q47,60 45,55 Q40,53 35,55 Q32,60 35,65" fill="%237877c6" opacity="0.3"/></svg>') no-repeat;
            background-size: contain;
        }

        .floral-border.bottom-right {
            bottom: 0;
            right: 0;
            width: 150px;
            height: 150px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M90,90 Q80,95 70,90 Q65,80 70,70 Q80,65 90,70 Q95,80 90,90 M85,85 Q80,88 75,85 Q73,80 75,75 Q80,73 85,75 Q88,80 85,85" fill="%23b795c5" opacity="0.3"/><path d="M70,70 Q60,75 50,70 Q45,60 50,50 Q60,45 70,50 Q75,60 70,70 M65,65 Q60,68 55,65 Q53,60 55,55 Q60,53 65,55 Q68,60 65,65" fill="%237877c6" opacity="0.3"/></svg>') no-repeat;
            background-size: contain;
        }

        .header {
            text-align: center;
            padding: 50px 40px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            position: relative;
        }

        .couple-names {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3.5em;
            font-weight: 700;
            letter-spacing: 3px;
            margin-bottom: 15px;
            animation: fadeIn 1s ease-in;
        }

        .event-date {
            font-family: 'Montserrat', sans-serif;
            font-size: 1em;
            font-weight: 300;
            letter-spacing: 1px;
            margin-bottom: 25px;
            opacity: 0.95;
        }

        .rsvp-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2em;
            font-weight: 600;
            letter-spacing: 2px;
            margin-bottom: 15px;
        }

        .rsvp-instruction {
            font-size: 0.9em;
            font-style: italic;
            opacity: 0.9;
            line-height: 1.5;
        }

        .countdown-section {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .countdown-title {
            font-size: 1em;
            margin-bottom: 15px;
            font-weight: 400;
        }

        .countdown-timer {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .time-unit {
            text-align: center;
        }

        .time-value {
            font-size: 2.2em;
            font-weight: 600;
            font-family: 'Cormorant Garamond', serif;
        }

        .time-label {
            font-size: 0.75em;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .content {
            padding: 40px;
        }

        .form-section {
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: #333;
            font-weight: 500;
            font-size: 0.95em;
        }

        input[type="tel"],
        input[type="number"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: 'Montserrat', sans-serif;
        }

        input:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 0 3px rgba(118, 75, 162, 0.1);
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 15px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .radio-option:hover {
            border-color: #764ba2;
            background: rgba(118, 75, 162, 0.05);
        }

        .radio-option input[type="radio"] {
            margin-right: 15px;
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #764ba2;
        }

        .radio-option.selected {
            border-color: #764ba2;
            background: rgba(118, 75, 162, 0.1);
        }

        button {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Montserrat', sans-serif;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(118, 75, 162, 0.3);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .message-box {
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            animation: fadeIn 0.5s ease-in;
        }

        .error-message {
            background: #fff3cd;
            border: 2px solid #ffc107;
            color: #856404;
        }

        .success-message {
            background: #d4edda;
            border: 2px solid #28a745;
            color: #155724;
        }

        .success-message h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2em;
            margin-bottom: 10px;
            color: #155724;
        }

        .decline-message {
            background: #f8d7da;
            border: 2px solid #dc3545;
            color: #721c24;
        }

        .decline-message h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2em;
            margin-bottom: 10px;
            color: #721c24;
        }

        .event-details {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 25px 0;
            border-left: 4px solid #764ba2;
        }

        .event-details h3 {
            font-family: 'Cormorant Garamond', serif;
            color: #764ba2;
            font-size: 1.8em;
            margin-bottom: 20px;
        }

        .detail-item {
            margin: 12px 0;
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
            line-height: 1.6;
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-label {
            font-weight: 600;
            color: #555;
        }

        .venue-link {
            color: #764ba2;
            text-decoration: none;
            font-weight: 600;
        }

        .venue-link:hover {
            text-decoration: underline;
        }

        .qr-container {
            text-align: center;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            margin: 25px 0;
            border: 2px dashed #764ba2;
        }

        .qr-container h3 {
            font-family: 'Cormorant Garamond', serif;
            color: #764ba2;
            font-size: 1.8em;
            margin-bottom: 15px;
        }

        .qr-code {
            margin: 20px auto;
            display: inline-block;
        }

        .qr-instruction {
            margin-top: 15px;
            font-weight: 600;
            color: #555;
        }

        .qr-data {
            margin-top: 15px;
            font-size: 0.9em;
            color: #666;
            line-height: 1.6;
        }

        .contact-info {
            background: #e7f3ff;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-weight: 500;
            color: #004085;
        }

        .faq-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
        }

        .faq-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2em;
            color: #764ba2;
            margin-bottom: 25px;
            text-align: center;
        }

        .faq-item {
            margin-bottom: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .faq-item:hover {
            background: #e9ecef;
        }

        .faq-question {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            font-size: 1.05em;
        }

        .faq-answer {
            color: #666;
            line-height: 1.6;
            font-style: italic;
        }
        
        .need-help {
            text-align: center;
            padding: 30px 20px;
            margin-top: 40px;
            border-top: 1px solid #e0e0e0;
        }
        
        .need-help-title {
            font-size: 1.1em;
            color: #333;
            margin-bottom: 10px;
            font-style: italic;
        }
        
        .need-help-text {
            font-size: 0.95em;
            color: #666;
            font-style: italic;
        }
        
        .footer {
            text-align: center;
            padding: 30px 20px;
            background: #f8f9fa;
            border-top: 2px solid #e0e0e0;
        }
        
        .footer-couple {
            font-weight: 700;
            font-size: 1.3em;
            letter-spacing: 2px;
            color: #764ba2;
            margin-bottom: 5px;
        }
        
        .footer-date {
            font-size: 1em;
            color: #666;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }

            .couple-names {
                font-size: 2.5em;
            }

            .content {
                padding: 30px 20px;
            }

            .countdown-timer {
                gap: 10px;
            }

            .time-value {
                font-size: 1.8em;
            }

            .floral-border {
                width: 100px;
                height: 100px;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="floral-border top-left"></div>
        <div class="floral-border top-right"></div>
        <div class="floral-border bottom-left"></div>
        <div class="floral-border bottom-right"></div>

        <div class="header">
            <div class="couple-names">UMAR & AIMAN</div>
            <div class="event-date">Sunday, 21st December, 2025<br>Karachi, Pakistan</div>
            <div class="rsvp-title">RSVP</div>
            <div class="rsvp-instruction">
                If you're responding for you/your family, you will be able to RSVP<br>
                for the entire group in one submission
            </div>

            <div class="countdown-section">
                <div class="countdown-title">RSVP Deadline: Wednesday, 5th November, 2025 at 11:59 PM PKT</div>
                <div class="countdown-timer" id="rsvpCountdown"></div>
            </div>
        </div>

        <div class="content">
            <div id="phoneVerification">
                <div class="form-group">
                    <label for="phoneInput">Please enter your phone number to find your reservation</label>
                    <input type="tel" id="phoneInput" placeholder="e.g., 03001234567" required>
                </div>
                <button onclick="verifyPhone()">Find My Reservation</button>
                <div id="errorMessage" class="message-box error-message hidden"></div>
            </div>

            <div id="rsvpForm" class="hidden">
                <div class="form-section">
                    <div class="form-group">
                        <label>Will you be attending?</label>
                        <div class="radio-group">
                            <label class="radio-option" onclick="selectOption(this, 'yes')">
                                <input type="radio" name="attending" value="yes" onchange="toggleGuestCount()">
                                <span>Yes, I'll be there</span>
                            </label>
                            <label class="radio-option" onclick="selectOption(this, 'no')">
                                <input type="radio" name="attending" value="no" onchange="toggleGuestCount()">
                                <span>Sorry, I can't make it</span>
                            </label>
                        </div>
                    </div>

                    <div id="guestCountGroup" class="form-group hidden">
                        <label for="guestCount">Number of Guests Attending</label>
                        <input type="number" id="guestCount" min="1" placeholder="Enter number of guests">
                    </div>

                    <button onclick="submitRSVP()" id="submitBtn">Confirm RSVP</button>
                    <div id="formError" class="message-box error-message hidden"></div>
                </div>
            </div>

            <div id="confirmationSection" class="hidden">
                <div id="successMsg" class="message-box success-message hidden">
                    <h2>RSVP Confirmed</h2>
                    <p>Thank you for confirming! We can't wait to celebrate with you!</p>
                </div>

                <div id="declineMsg" class="message-box decline-message hidden">
                    <h2>We'll Miss You</h2>
                    <p>Sorry we missed you. Please remember us in your prayers.</p>
                </div>

                <div id="eventDetailsSection" class="hidden">
                    <div class="event-details">
                        <h3>Event Details</h3>
                        <div class="detail-item">
                            <span class="detail-label">Date:</span> Sunday, 21st December, 2025
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Venue:</span> 
                            <a href="https://share.google/RHJyp52NljSPmbKHZ" target="_blank" class="venue-link">Ballroom 19, Karachi</a>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Schedule:</span><br>
                            8:00 PM - Welcome/Reception<br>
                            9:30 PM - Dinner<br>
                            11:00 PM - Rukhsati
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Important:</span> Punctuality of time will be highly appreciated. We will follow the time strictly as mentioned.
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Note:</span> Sorry, no boxed gifts please. Your presence is our present!
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Confirmed Guests:</span> <span id="confirmedGuests"></span>
                        </div>
                    </div>

                    <div class="qr-container">
                        <h3>Your Entry QR Code</h3>
                        <p class="qr-instruction">Please save this QR code and present it at the venue entrance</p>
                        <div id="qrcode" class="qr-code"></div>
                        <div id="qrData" class="qr-data"></div>
                    </div>

                    <button onclick="addToCalendar()">Add to Calendar</button>
                </div>

                <div class="contact-info">
                    For any questions or to edit your response, please contact the Point of Contact mentioned on your invitation card.
                </div>
            </div>

            <div class="faq-section">
                <div class="faq-item">
                    <div class="faq-question">Q: Can I bring an additional guest?</div>
                    <div class="faq-answer">A: Due to limited space, we are only able to accommodate guests formally invited.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Q: Need help?</div>
                    <div class="faq-answer">A: Please refer to the RSVP tab on your invitation card.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Q: Can I bring box gifts?</div>
                    <div class="faq-answer">A: Sorry, no boxed gifts please. Your presence is our present!</div>
                </div>
            </div>
            
            <div class="need-help">
                <div class="need-help-title">Need Help?</div>
                <div class="need-help-text">Please refer to the RSVP tab on your invitation card</div>
            </div>
        </div>
        
        <div class="footer">
            <div class="footer-couple">U&A</div>
            <div class="footer-date">21.12.2025</div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script>
        let guestData = null;

        // Countdown timer for RSVP deadline
        function updateCountdown() {
            const rsvpDeadline = new Date('2025-11-05T23:59:59+05:00').getTime();
            const now = new Date().getTime();
            const distance = rsvpDeadline - now;

            if (distance < 0) {
                document.getElementById('rsvpCountdown').innerHTML = '<div class="time-unit"><div class="time-value">CLOSED</div></div>';
                return;
            }

            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            document.getElementById('rsvpCountdown').innerHTML = `
                <div class="time-unit">
                    <div class="time-value">${days}</div>
                    <div class="time-label">Days</div>
                </div>
                <div class="time-unit">
                    <div class="time-value">${hours}</div>
                    <div class="time-label">Hours</div>
                </div>
                <div class="time-unit">
                    <div class="time-value">${minutes}</div>
                    <div class="time-label">Minutes</div>
                </div>
                <div class="time-unit">
                    <div class="time-value">${seconds}</div>
                    <div class="time-label">Seconds</div>
                </div>
            `;
        }

        updateCountdown();
        setInterval(updateCountdown, 1000);

        function selectOption(element, value) {
            document.querySelectorAll('.radio-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
        }

        function verifyPhone() {
            const phone = document.getElementById('phoneInput').value.trim();
            const errorDiv = document.getElementById('errorMessage');
            
            if (!phone) {
                errorDiv.textContent = 'Please enter your phone number.';
                errorDiv.classList.remove('hidden');
                return;
            }

            // Check if past deadline
            const now = new Date();
            const deadline = new Date('2025-11-05T23:59:59+05:00');
            if (now > deadline) {
                errorDiv.textContent = 'RSVP period has closed. For questions please contact the Point of Contact on your invitation card.';
                errorDiv.classList.remove('hidden');
                return;
            }

            errorDiv.classList.add('hidden');
            const button = document.querySelector('#phoneVerification button');
            button.disabled = true;
            button.textContent = 'Searching...';

            google.script.run
                .withSuccessHandler(handlePhoneVerification)
                .withFailureHandler(handleError)
                .checkPhoneNumber(phone);
        }

        function handlePhoneVerification(result) {
            const button = document.querySelector('#phoneVerification button');
            button.disabled = false;
            button.textContent = 'Find My Reservation';
            
            const errorDiv = document.getElementById('errorMessage');
            
            if (!result.found) {
                errorDiv.textContent = 'Phone number not recognized. Please verify your number or contact the Point of Contact mentioned on your invitation card before the RSVP deadline.';
                errorDiv.classList.remove('hidden');
                return;
            }

            if (result.alreadySubmitted) {
                errorDiv.innerHTML = `
                    <strong>Response Already Submitted</strong><br><br>
                    Your response was submitted on ${result.submittedDate}.<br><br>
                    If you would like to edit your response, please contact the Point of Contact mentioned on your invitation card before November 5, 2025.
                `;
                errorDiv.classList.remove('hidden');
                return;
            }

            guestData = result;
            document.getElementById('phoneVerification').classList.add('hidden');
            document.getElementById('rsvpForm').classList.remove('hidden');
        }

        function toggleGuestCount() {
            const attending = document.querySelector('input[name="attending"]:checked').value;
            const guestCountGroup = document.getElementById('guestCountGroup');
            
            if (attending === 'yes') {
                guestCountGroup.classList.remove('hidden');
            } else {
                guestCountGroup.classList.add('hidden');
            }
        }

        function submitRSVP() {
            const attending = document.querySelector('input[name="attending"]:checked');
            const errorDiv = document.getElementById('formError');
            
            if (!attending) {
                errorDiv.textContent = 'Please select whether you will be attending.';
                errorDiv.classList.remove('hidden');
                return;
            }

            const isAttending = attending.value === 'yes';
            let numberOfGuests = 0;

            if (isAttending) {
                numberOfGuests = parseInt(document.getElementById('guestCount').value);
                
                if (!numberOfGuests || numberOfGuests < 1) {
                    errorDiv.textContent = 'Please enter the number of guests attending.';
                    errorDiv.classList.remove('hidden');
                    return;
                }

                if (numberOfGuests > guestData.maxGuests) {
                    errorDiv.innerHTML = `
                        Guest count exceeded. Please contact the Point of Contact on your invitation card.
                    `;
                    errorDiv.classList.remove('hidden');
                    return;
                }
            }

            errorDiv.classList.add('hidden');
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';

            const submissionData = {
                phone: document.getElementById('phoneInput').value.trim(),
                attending: isAttending ? 'Yes' : 'No',
                numberOfGuests: numberOfGuests,
                side: guestData.side,
                row: guestData.row,
                sheetName: guestData.sheetName
            };

            google.script.run
                .withSuccessHandler((result) => handleSubmissionSuccess(result, isAttending, numberOfGuests))
                .withFailureHandler(handleError)
                .submitRSVP(submissionData);
        }

        function handleSubmissionSuccess(result, isAttending, numberOfGuests) {
            document.getElementById('rsvpForm').classList.add('hidden');
            document.getElementById('confirmationSection').classList.remove('hidden');

            if (isAttending) {
                document.getElementById('successMsg').classList.remove('hidden');
                document.getElementById('eventDetailsSection').classList.remove('hidden');
                document.getElementById('confirmedGuests').textContent = numberOfGuests;
            } else {
                document.getElementById('declineMsg').classList.remove('hidden');
            }
        }

        function handleError(error) {
            console.error('Error:', error);
            const errorDiv = document.getElementById('formError').classList.contains('hidden') 
                ? document.getElementById('errorMessage') 
                : document.getElementById('formError');
            
            errorDiv.textContent = 'An error occurred. Please try again or contact the Point of Contact mentioned on your invitation card.';
            errorDiv.classList.remove('hidden');
            
            const submitBtn = document.getElementById('submitBtn');
            if (submitBtn) {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Confirm RSVP';
            }
        }

        function addToCalendar() {
            const event = {
                title: 'Umar & Aiman - Wedding Reception',
                start: '20251221T200000',
                end: '20251221T230000',
                description: 'Wedding Reception\\n\\nSchedule:\\n8:00 PM - Welcome/Reception\\n9:30 PM - Dinner\\n11:00 PM - Rukhsati\\n\\nVenue: Ballroom 19, Karachi\\n\\nNote: Punctuality of time will be highly appreciated. We will follow the time strictly as mentioned. No boxed gifts please - your presence is our present!',
                location: 'Ballroom 19, Karachi'
            };

            const icsContent = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Wedding RSVP//EN
BEGIN:VEVENT
DTSTART:${event.start}
DTEND:${event.end}
SUMMARY:${event.title}
DESCRIPTION:${event.description}
LOCATION:${event.location}
STATUS:CONFIRMED
END:VEVENT
END:VCALENDAR`;

            const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'umar-aiman-wedding.ics';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>title">Q/A</div>
                
                <div class="faq-item">
                    <div class="faq-question">Q: What are the event dates and venue?</div>
                    <div class="faq-answer">A: Please refer to your invitation card for more event details.</div>
                </div>

                <div class="faq-item">
                    <div class="faq-question">Q: What number should I use to submit the response?</div>
                    <div class="faq-answer">A: Please use the same number where you received the invitation card. If you're responding for yourself/your family, you will be able to RSVP for the entire group in one submission. Still having issues or need to edit your submitted response, please contact the Point of Contact on your invitation card.</div>
                </div>

                <div class="faq-
